<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Intervall Timer - Testdatei</title>
  <link rel="icon" type="image/png" href="favicon.png">
  <style>
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:#064e3b;color:#fff;display:flex;min-height:100vh;align-items:center;justify-content:center}
    .card{background:#0b3b2d;border:1px solid #1f6b53;border-radius:20px;padding:20px;max-width:420px;width:92%}
    h1{margin:0 0 16px;font-size:28px;text-align:center}
    .row{display:flex;gap:8px;flex-wrap:wrap;justify-content:center;margin-bottom:10px}
    button{cursor:pointer;border:0;border-radius:12px;padding:10px 14px;background:#059669;color:#fff;font-weight:600}
    button:disabled{opacity:.5;cursor:default}
    .ghost{background:#6b7280}
    .warn{background:#ca8a04}
    .box{background:#052e24;border-radius:14px;padding:14px;margin:10px 0;text-align:center}
    .big{font:700 54px/1 monospace}
    .bar{height:8px;background:#1f2937;border-radius:999px;overflow:hidden;margin:14px 0}
    .bar>div{height:100%;width:0;background:linear-gradient(90deg,#f59e0b,#10b981)}
    .lbl{font-size:13px;color:#c7d2fe;opacity:.9}
  </style>
</head>
<body>
  <div class="card">
    <h1>Intervall Timer</h1>

    <div class="box">
      <div class="lbl">Timer-Dauer einstellen</div>
      <div class="row">
        <button class="preset" data-min="1">1 Min</button>
        <button class="preset" data-min="3">3 Min</button>
        <button class="preset" data-min="6">6 Min</button>
        <button class="preset" data-min="10">10 Min</button>
        <button class="preset" data-min="15">15 Min</button>
      </div>
      <div class="row">
        <span class="lbl">Eigene Zeit:</span>
        <input id="customMin" type="number" min="1" max="60" value="6" style="width:64px;text-align:center;border-radius:10px;border:1px solid #334155;padding:8px;background:#021b15;color:#fff">
        <span class="lbl">Min</span>
        <button id="setBtn" class="warn">Setzen</button>
      </div>
    </div>

    <div class="box">
      <div id="time" class="big">06:00</div>
      <div id="status">Bereit zum Start</div>
    </div>

    <div class="box">
      <div class="lbl">Signale gegeben</div>
      <div id="count" style="font-size:28px;font-weight:700;color:#34d399">0</div>
    </div>

    <div class="bar"><div id="prog"></div></div>

    <div class="row">
      <button id="start">Start</button>
      <button id="pause" class="warn" disabled>Pause</button>
      <button id="reset" class="ghost">Reset</button>
    </div>

    <div style="text-align:center;margin-top:10px">
      <div class="lbl">Nächstes Signal in:</div>
      <div id="next" style="font-size:20px;font-weight:700">20s</div>
    </div>
  </div>

  <script>
    class IntervalTimer {
      constructor(){
        this.total=6*60; this.signal=20;
        this.left=this.total; this.toSignal=this.signal;
        this.count=0; this.run=false; this.t=null;
        this.$=id=>document.getElementById(id);
        this.time=this.$('time'); this.status=this.$('status');
        this.countEl=this.$('count'); this.prog=this.$('prog'); this.next=this.$('next');
        this.startBtn=this.$('start'); this.pauseBtn=this.$('pause'); this.resetBtn=this.$('reset');
        this.custom=document.getElementById('customMin'); this.setBtn=this.$('setBtn');
        document.querySelectorAll('.preset').forEach(b=>b.onclick=()=>this.setDuration(+b.dataset.min));
        this.setBtn.onclick=()=>this.setDuration(+this.custom.value);
        this.startBtn.onclick=()=>this.start(); this.pauseBtn.onclick=()=>this.pause(); this.resetBtn.onclick=()=>this.reset();
        this.draw();
      }
      setDuration(min){ if(this.run) return;
        this.total=min*60; this.left=this.total; this.toSignal=this.signal; this.count=0;
        this.status.textContent='Bereit zum Start'; this.draw();
      }
      start(){ if(this.run) return; this.run=true;
        this.status.textContent='Timer läuft...'; this.startBtn.disabled=true; this.pauseBtn.disabled=false;
        this.t=setInterval(()=>this.tick(),1000);
      }
      pause(){ if(!this.run) return; this.run=false; clearInterval(this.t);
        this.status.textContent='Pausiert'; this.startBtn.disabled=false; this.pauseBtn.disabled=true;
      }
      reset(){ this.run=false; clearInterval(this.t); this.left=this.total; this.toSignal=this.signal; this.count=0;
        this.status.textContent='Zurückgesetzt'; this.startBtn.disabled=false; this.pauseBtn.disabled=true; this.draw();
      }
      tick(){
        this.left--; this.toSignal--;
        if(this.toSignal<=0){ this.beep(); this.count++; this.toSignal=this.signal; this.countEl.textContent=this.count; }
        if(this.left<=0){ this.finish(); return; }
        this.draw();
      }
      finish(){ this.run=false; clearInterval(this.t); this.left=0; this.toSignal=0;
        this.status.textContent='Timer beendet!'; this.startBtn.disabled=true; this.pauseBtn.disabled=true; this.draw(); this.jingle();
      }
      draw(){
        const m=Math.floor(this.left/60).toString().padStart(2,'0');
        const s=(this.left%60).toString().padStart(2,'0');
        this.time.textContent=`${m}:${s}`;
        const p=((this.total-this.left)/this.total)*100; this.prog.style.width=p+'%';
        this.next.textContent=(this.toSignal>0?this.toSignal:0)+'s';
      }
      beep(){
        try{
          const ac=new (window.AudioContext||window.webkitAudioContext)();
          const o=ac.createOscillator(), g=ac.createGain();
          o.connect(g); g.connect(ac.destination);
          o.frequency.value=800; o.type='sine';
          g.gain.setValueAtTime(0.25, ac.currentTime);
          g.gain.exponentialRampToValueAtTime(0.01, ac.currentTime+0.25);
          o.start(); o.stop(ac.currentTime+0.25);
          if(navigator.vibrate) navigator.vibrate(60);
        }catch{}
      }
      jingle(){
        try{
          const ac=new (window.AudioContext||window.webkitAudioContext)();
          [523.25,659.25,783.99,1046.5].forEach((f,i)=>{
            const o=ac.createOscillator(), g=ac.createGain();
            o.connect(g); g.connect(ac.destination); o.frequency.value=f; o.type='sine';
            const t=ac.currentTime+i*0.28; g.gain.setValueAtTime(0, t);
            g.gain.linearRampToValueAtTime(0.35, t+0.05);
            g.gain.exponentialRampToValueAtTime(0.01, t+0.25);
            o.start(t); o.stop(t+0.3);
          });
        }catch{}
      }
    }
    document.addEventListener('DOMContentLoaded',()=>new IntervalTimer());
  </script>
</body>
</html>
